---
import Select from "./Select.astro";

const ageGroups = [
	{ value: 1, label: "18-22" },
	{ value: 2, label: "23-29" },
	{ value: 3, label: "30-39" },
	{ value: 4, label: "40-49" },
	{ value: 5, label: "50-59" },
	{ value: 6, label: "60-69" },
	{ value: 7, label: "70-79" },
	{ value: 8, label: "80 and over" },
];

const religiosity = [
	{ value: 1, label: "Very religious, Haredi" },
	{ value: 2, label: "Religious" },
	{ value: 3, label: "Traditional religious" },
	{ value: 4, label: "Traditional, not so religious" },
	{ value: 5, label: "Non-religious, secular" },
];

const sectors = [
	{ value: 1, label: "Jewish" },
	{ value: 2, label: "Arab" },
];

const sexOptions = [
	{ value: 1, label: "Male" },
	{ value: 2, label: "Female" },
	{ value: 3, label: "Other" },
];

const educationLevels = [
	{ value: 1, label: "No formal education" },
	{ value: 2, label: "Elementary school" },
	{ value: 3, label: "Partial high school" },
	{ value: 4, label: "Complete high school - without matriculation diploma" },
	{ value: 5, label: "Complete high school - with matriculation diploma" },
	{ value: 6, label: "Post high school, non-academic" },
	{ value: 7, label: "Partial academic degree" },
	{ value: 8, label: "Full academic degree - BA" },
	{ value: 9, label: "Full academic degree - MA or higher" },
];

const ethnicities = [
	{ value: 1, label: "Ashkenazi" },
	{ value: 2, label: "Sephardic" },
	{ value: 3, label: "Mizrachi" },
	{ value: 5, label: "Both" },
	{ value: 10, label: "Israeli" },
	{ value: 99, label: "Other" },
];
---

<form class="flex flex-col" id="predictionForm">
	<Select id="sex" name="sex" label="Sex" options={sexOptions} />

	<Select
		id="ageGroup"
		name="ageGroup"
		label="Age Group"
		options={ageGroups}
	/>

	<Select
		id="educationLevel"
		name="educationLevel"
		label="Education Level"
		options={educationLevels}
	/>

	<Select id="sector" name="sector" label="Sector" options={sectors} />

	<Select
		id="ethnicity"
		name="ethnicity"
		label="Ethnicity"
		options={ethnicities}
	/>

	<Select
		id="religiosity"
		name="religiosity"
		label="Religiosity"
		options={religiosity}
	/>

	<Select
		id="deprivationScale"
		name="deprivationScale"
		label="Deprivation Scale"
		options={[
			{ value: 0, label: "Bottom" },
			{ value: 1, label: "1" },
			{ value: 2, label: "2" },
			{ value: 3, label: "3" },
			{ value: 4, label: "4" },
			{ value: 5, label: "5" },
			{ value: 6, label: "6" },
			{ value: 7, label: "7" },
			{ value: 8, label: "8" },
			{ value: 9, label: "9" },
			{ value: 10, label: "Top" },
		]}
	/>
</form>

<script>
	const sectorSelect = document.getElementById('sector') as HTMLSelectElement;
	const ethnicitySelect = document.getElementById('ethnicity') as HTMLSelectElement;

	const arabOption = { value: '0', label: 'Arab' };
	const ethnicities = [
		{ value: '1', label: 'Ashkenazi' },
		{ value: '2', label: 'Sephardic' },
		{ value: '3', label: 'Mizrachi' },
		{ value: '5', label: 'Both' },
		{ value: '10', label: 'Israeli' },
		{ value: '99', label: 'Other' },
	];

	function updateEthnicityOptions(): void {
		if (!sectorSelect || !ethnicitySelect) return;

		const selectedSector = sectorSelect.value;

		if (selectedSector === '2') { 
			ethnicitySelect.innerHTML = '';
			ethnicitySelect.append(new Option(arabOption.label, arabOption.value));
			ethnicitySelect.disabled = true;
		} else {
			ethnicitySelect.innerHTML = '';
			ethnicities.forEach(option => {
				ethnicitySelect.append(new Option(option.label, option.value));
			});
			ethnicitySelect.disabled = false;
		}
	}

	sectorSelect.addEventListener('change', updateEthnicityOptions);
	updateEthnicityOptions();
</script>
